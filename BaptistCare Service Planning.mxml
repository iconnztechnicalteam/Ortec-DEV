<?xml version="1.0" encoding="UTF-8"?>
<MovilizerRequest numResponses="1000" requestTrackingKey="" synchronousResponse="true" systemId="${#Project#QASystemID}" systemPassword="${#Project#QAPassword}" useAutoAcknowledge="true" xmlns="http://movilitas.com/movilizer/v16">

    <moveletDelete moveletKey="ORTEC_BC_SP_v1.1"/>
    <moveletDelete moveletKey="ORTEC_BC_INT_v1.1"/>
    <moveletDelete moveletKey="ORTEC_BC_INT2_v1.1"/>

    <moveletSet>
//---------------------------------------------------------------------------------------    
// Service Planning Movelet
//---------------------------------------------------------------------------------------    
        <movelet encryptionAlgorithm="" filterValue="" icon="111"
            initialQuestionKey="10" mafAppSpace=""
            metaMoveletType="NONE" moveletDownloadPriority="0"
            moveletKey="ORTEC_BC_SP_v1.1" moveletKeyExtension=""
            moveletType="MULTI" moveletVersion="0"
            namespace="E16QA#E16QA#ORTEC_BC" priority="0"
            privateNamespace="true" replyUploadPriority="0"
            responseQueue="action" syncPriority="NONE"
            transactional="true"
            validTillDate="2999-06-30T11:59:59.000Z" visible="true">

//---------------------------------------------------------------------------------------    
//	Task Calendar
//---------------------------------------------------------------------------------------                        
            <question backNavigationAllowed="true" key="1"
                sortAnswersByClientKey="false"
                tableOptionsEnabled="true" tableRowDetailsEnabled="true"
                title="Task Calendar" type="8">
                <answer action="NONE" attributeType="72"
                    dummyAnswer="false" key="#1_1" nextQuestionKey="1"
                    onScreenValueChangeEventTrigger="NONE" position="0"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>Ok</text>
                </answer>
                <answer action="NONE" attributeType="70"
                    dummyAnswer="false" key="#1_11"
                    nextQuestionKey="END"
                    onScreenValueChangeEventTrigger="NONE" position="3"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>2019-03-01</text>
                </answer>
                <answer action="NONE" attributeType="0"
                    dummyAnswer="true" key="#1_9" nextQuestionKey="21"
                    onScreenValueChangeEventTrigger="NONE" position="5"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>2019-02-11¤¤¤New Appointment</text>
                </answer>
                <answer action="NONE" attributeType="69"
                    dummyAnswer="true" key="#1_14" nextQuestionKey="1"
                    onScreenValueChangeEventTrigger="NONE" position="5"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>2019-03-01¤2019-03-08</text>
                </answer>
                <answer action="NONE" attributeType="0"
                    dummyAnswer="true" key="#1_10" nextQuestionKey="21"
                    onScreenValueChangeEventTrigger="NONE" position="6"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>2019-02-11¤¤¤New Appointment</text>
                </answer>
                <onEnterAssignment>

sep 		= '¤';
$local:RLZ	= null;

// Current system timestamp
CurrentTime = systemTime();
oneDay 		= 84600000;  
Yesterday	= systemTime() - oneDay;

// Timestamp to date
CurrentDate = timestampToDate(CurrentTime, $global:timezone, true);

// Set todays date as the default date and annotate with W for weekly view
if ($local:view == '1')
{
DefaultDate = concat(CurrentDate, 'W');
setAnswerValueByClientKey($answer:'#1_11', '', DefaultDate);
}
else
{
setAnswerValueByClientKey($answer:'#1_11', '', CurrentDate);
}

// Set visible time range
EndTimestamp	= CurrentTime + $global:Horizon;
RangeEnd		= timestampToDate(EndTimestamp, $global:timezone, true);
Range 			= concat(CurrentDate, sep, '2019-04-26'); //RangeEnd);
addAnswer($answer:'#1_14', '', Range);

// Disable month view
setCustomizingProperty($customizing:'screen.calendar.monthview.enabled', false);

// Get masterdata
$local:mdTasks = queryMasterData($masterdata:'action', $global:device, filterConfig, {'result' : 'all';});

// Load appointments
for (i : $local:mdTasks)
{

	// Interaction configuration - visible on calendar screen
	arrInt = $global:cfgInteraction[$local:mdTasks[i]['data']['interaction']];
	if (arrInt['calendar'] == '')
	{
		continue;
	}
	
	// Get updated times
	$local:mdTimes 	= getMasterData($masterdata:'times', i);
	$local:key 		= i;
	call($local:AppTimes)();
	
	// Status
	if ($local:mdTimes['data']['status'] == null)
	{
		varStatus = $local:mdTasks[$local:key]['data']['status'];
	}
	else
	{
		varStatus = $local:mdTimes['data']['status'];
	}
		
	// Less than today then skip
	if (varStatus != 'started')
	{
		ApptTime = dateToTimestamp($global:arrAppt['StartTmStmp'], true);
		if (ApptTime &lt; Yesterday)
		{ 
			continue;
		}
	}	
			
	// Set date		
	day = 'dd'; month = 'mm'; year = 'yyyy'; //to make them char fields
	day			= subString($local:mdTasks[i]['filter4'], 6, 8);
	month		= subString($local:mdTasks[i]['filter4'], 4, 6);
	year		= subString($local:mdTasks[i]['filter4'], 0, 4);
	NewDate 	= concat(year, '-', month, '-', day);
	NewDesc 	= $local:mdTasks[i]['filter1'];

	// Set time
	TimeStamp 	= dateToTimestamp($global:arrAppt['StartTmStmp']);	
	NewStart	= timestampToTime(TimeStamp, $global:timezone, true); 	
	TimeStamp 	= dateToTimestamp($global:arrAppt['FinishTmStmp']);	
	NewEnd 		= timestampToTime(TimeStamp, $global:timezone, true);
	
	NewAnswer 	= concat(NewDate, sep, NewStart, sep, NewEnd, sep, NewDesc, sep);
	addAnswer($answer:'#1_9', i, NewAnswer);	
	
	if ((substring($local:mdTasks[i]['data']['interaction'], 0, 4) == 'task') ?and ($local:mdTasks[$local:key]['data']['realisationGroupSequence'] != null))
	{
		$local:RLZ[$local:mdTasks[$local:key]['data']['shiftId']][$local:mdTasks[$local:key]['data']['realisationGroup']][$local:mdTasks[$local:key]['data']['realisationGroupSequence']]['task'] 	= $local:key;
		$local:RLZ[$local:mdTasks[$local:key]['data']['shiftId']][$local:mdTasks[$local:key]['data']['realisationGroup']][$local:mdTasks[$local:key]['data']['realisationGroupSequence']]['rlz'] 	= false;
		$local:RLZ[$local:mdTasks[$local:key]['data']['shiftId']][$local:mdTasks[$local:key]['data']['realisationGroup']][$local:mdTasks[$local:key]['data']['realisationGroupSequence']]['status']	= varStatus;
	}
}
	result = call($local:NextRlz)();

	$local:key 		= null;
	$local:mdTimes	= null;
	$global:arrAppt	= null;
</onEnterAssignment>
                <onLeaveOkPrepareAssignment>
	// Get focused answer and save value
	clientKey = getQuestionClientKey();
	
	if (clientKey != null)
	{		
		//Find the appointment
		$global:selAppt = getMasterData($masterdata:'action', clientKey); 
	}
</onLeaveOkPrepareAssignment>
                <onLeaveOkPersistAssignment/>
                <onLeaveBackAssignment/>
                <onScreenValueChangeEvent/>
                <onExternalEvent/>
            </question>
//---------------------------------------------------------------------------------------    
//	Task View Selection
//---------------------------------------------------------------------------------------                        
            <question backNavigationAllowed="true" key="10"
                sortAnswersByClientKey="false"
                tableOptionsEnabled="true" tableRowDetailsEnabled="true"
                title="Task View Selection" type="6">
                <answer action="NONE" clientKey="10_2"
                    dummyAnswer="false" icon="43" key="#10_2"
                    nextQuestionKey="1"
                    onScreenValueChangeEventTrigger="NONE" position="1"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>Calendar Day</text>
                </answer>
                <answer action="NONE" clientKey="10_3"
                    dummyAnswer="false" icon="44" key="#10_3"
                    nextQuestionKey="6"
                    onScreenValueChangeEventTrigger="NONE" position="2"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>Task List</text>
                </answer>
                <answer action="NONE" clientKey="10_1"
                    dummyAnswer="false" icon="43" key="#10_1"
                    nextQuestionKey="1"
                    onScreenValueChangeEventTrigger="NONE" position="3"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>Calendar Week</text>
                </answer>
                <answer action="NONE" clientKey="10_4"
                    dummyAnswer="false" icon="25" key="#10_4"
                    nextQuestionKey="11"
                    onScreenValueChangeEventTrigger="NONE" position="4"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>Route</text>
                </answer>
                <text>Defaults to your previous selection</text>
                <onEnterAssignment>
	clearAnswerValues();

// Set the default answer
switch ($local:view)
{
    case 1 :
    {
        setAnswerValueByClientKey($answer:'#10_1', '10_1', 'X');
    }
    case 2 :
    {
        setAnswerValueByClientKey($answer:'#10_2', '10_2', 'X');
    }
    case 3 :
    {
        setAnswerValueByClientKey($answer:'#10_3', '10_3', 'X');
    }
    case 4 :
    {
        setAnswerValueByClientKey($answer:'#10_4', '10_4', 'X');
    }
}

// Button colour
setButtonColors($answer:'#10_1', '10_1', '#ffffff', '#ffffff', '#258fc3');
setButtonColors($answer:'#10_2', '10_2', '#ffffff', '#ffffff', '#258fc3');
setButtonColors($answer:'#10_3', '10_3', '#ffffff', '#ffffff', '#258fc3');
setButtonColors($answer:'#10_4', '10_4', '#ffffff', '#ffffff', '#258fc3');

	// Hide route option
	removeAnswerByClientKey($answer:'#10_4', '10_4');
	
</onEnterAssignment>
                <onLeaveOkPrepareAssignment>$local:count = 0;</onLeaveOkPrepareAssignment>
                <onLeaveOkPersistAssignment>

// work out which option was selected and save for later
SelAnswer 		= getQuestionClientKey();
$local:cal 		= false;
$local:tasklist = false;

if (SelAnswer == '10_1')
	{ $local:view = 'WEEK'; }

if (SelAnswer == '10_1')
	{ $local:view = 1; 
	$local:cal = true; }

if (SelAnswer == '10_2')
	{ $local:view = 2; 
	$local:cal = true; }

if (SelAnswer == '10_3')
	{ $local:view = 3; 
	$local:tasklist = true; }

if (SelAnswer == '10_4')
	{ $local:view = 4; }
	
</onLeaveOkPersistAssignment>
                <onLeaveBackAssignment>$local:count = 0;</onLeaveBackAssignment>
                <onExternalEvent/>
            </question>
//---------------------------------------------------------------------------------------    
// Route
//---------------------------------------------------------------------------------------                        
            <question backNavigationAllowed="true" key="11"
                sortAnswersByClientKey="true" tableOptionsEnabled="true"
                tableRowDetailsEnabled="true" title="Route" type="15">
                <answer action="NONE" attributeType="34"
                    dummyAnswer="false" key="#11_1" nextQuestionKey="10"
                    onScreenValueChangeEventTrigger="NONE" position="0"
                    sortAnswerItemsByClientKey="true" timerBasedScreenValueChangeEvent="false">
                    <text>ROUTE;STANDARD;NOT_ACTIVE;driving</text>
                </answer>
                <answer action="NONE" attributeType="0"
                    dummyAnswer="true" key="#11_2" nextQuestionKey="10"
                    onScreenValueChangeEventTrigger="NONE" position="1"
                    sortAnswerItemsByClientKey="true" timerBasedScreenValueChangeEvent="false">
                    <text>Location 1¤0.0,0.0¤#1a9198¤Y</text>
                </answer>
                <onEnterAssignment>
// Current system timestamp
oneDay 		= 84600000;          
CurrentTime = systemTime() - oneDay;  

// Get masterdata
mdTaskArray = queryMasterData($masterdata:'action', $global:device, filterConfig, {'result' : 'all';});

// Load tasks
count 	= 0;
sep		= '¤';
for (i : mdTaskArray)
{
	
	// Less than today then skip
	ApptTime = dateToTimestamp(mdTaskArray[i]['data']['starttime'], true);
	if (ApptTime &lt; CurrentTime)
	{ 
		continue;
	}

	// Interaction configuration
	arrInt = $global:cfgInteraction[mdTaskArray[i]['data']['interaction']];
	if (arrInt['route'] == '')
	{
		continue;
	}
	
	// Only real actions have realization group
	if  ((mdTaskArray[i]['data']['realisationGroup'] == null) 
		?or (mdTaskArray[i]['data']['realisationGroup'] == '') 
		?or (mdTaskArray[i]['data']['realisationGroup'] == ' '))
	{
		//continue;
	}
	
	// Must have coordinates
	if (mdTaskArray[i]['data']['lat'] == null)
	{
		continue;
	}
	
	// Set the realization group from the first valid action
	if (realGroup == null)
	{
		realGroup = mdTaskArray[i]['data']['realisationGroup'];
	}
	
	// Only show those in the same realization group
	if (mdTaskArray[i]['data']['realisationGroup'] != realGroup)
	{ 
		continue;
	}			

	count 		= count + 1;
	clientKey 	= concat('11_2_', count);
	coordinates = concat(mdTaskArray[i]['data']['lat'], ',', mdTaskArray[i]['data']['long']);
	location	= concat(mdTaskArray[i]['filter1'], sep, coordinates, sep, '#F37021', sep, 'Y');
	addanswer($answer:'#11_2', clientKey, location);

}	
</onEnterAssignment>
                <onLeaveOkPrepareAssignment/>
                <onLeaveOkPersistAssignment/>
                <onLeaveBackAssignment/>
                <onScreenValueChangeEvent/>
                <onExternalEvent/>
            </question>
//---------------------------------------------------------------------------------------    
// Navigate
//---------------------------------------------------------------------------------------                        
            <question backNavigationAllowed="true" key="12"
                sortAnswersByClientKey="false"
                tableOptionsEnabled="true" tableRowDetailsEnabled="true"
                title="Navigate" type="41">
                <answer action="NONE" dummyAnswer="false" key="#12_1"
                    nextQuestionKey="21"
                    onScreenValueChangeEventTrigger="NONE" position="0"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false"/>
                <onEnterAssignment>// Open maps app
					call($global:pathfinder)($global:lat, $global:long);
				</onEnterAssignment>
                <onLeaveOkPrepareAssignment/>
                <onLeaveOkPersistAssignment/>
                <onLeaveBackAssignment/>
            </question>
//---------------------------------------------------------------------------------------    
// Task Detail
//---------------------------------------------------------------------------------------                        
            <question backNavigationAllowed="true" key="2"
                labelAlignment="LEFT" sortAnswersByClientKey="false"
                tableOptionsEnabled="true" tableRowDetailsEnabled="true"
                title="Task Detail" type="5" valueAlignment="LEFT">
                <answer action="NONE" attributeType="8" clientKey="2_1"
                    colIndex="0" columnSizeType="ROWS"
                    dummyAnswer="false" key="#2_1" labelAlignment="LEFT"
                    labelFontSize="LARGE" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="1"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>%plcName%</text>
                </answer>
                <answer action="NONE" attributeType="8" clientKey="2_6"
                    columnSizeType="ROWS" dummyAnswer="false" key="#2_6"
                    labelAlignment="LEFT" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="2"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>%plcType%</text>
                </answer>
                <answer action="NONE" attributeType="8" clientKey="2_4"
                    columnSizeType="ROWS" dummyAnswer="false" key="#2_4"
                    labelAlignment="LEFT" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="3"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>%plcAddress%</text>
                </answer>
                <answer action="NONE" attributeType="8" clientKey="2_7"
                    columnSizeType="ROWS" dummyAnswer="false" key="#2_7"
                    labelAlignment="LEFT" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="3"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>%plcLocation%</text>
                </answer>
                <answer action="NONE" attributeType="-127"
                    bgColor="#FFFFFF" clientKey="2_40"
                    dummyAnswer="false" inputFieldAction="GOTO"
                    key="#2_40" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="4"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>Email</text>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="-125"
                    bgColor="#FFFFFF" clientKey="2_41"
                    dummyAnswer="false" inputFieldAction="GOTO"
                    key="#2_41" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="4"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>Phone</text>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="8" clientKey="2_8"
                    columnSizeType="ROWS" dummyAnswer="false" key="#2_8"
                    labelAlignment="LEFT" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="5"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>%plcReference%</text>
                </answer>
                <answer action="NONE" attributeType="14"
                    clientKey="2_15" columnSizeType="ROWS"
                    dummyAnswer="false" icon="115" key="#2_15"
                    labelAlignment="CENTER" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="SYNCHRONOUS"
                    position="6" sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>Navigate</text>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="33" clientKey=""
                    columnSizeType="LEFT" dummyAnswer="true"
                    groupId="10" key="#2_9" labelFontSize="SMALL"
                    nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="7"
                    sortAnswerItemsByClientKey="false"
                    timerBasedScreenValueChangeEvent="false" valueFontSize="SMALL">
                    <text/>
                </answer>
                <answer action="NONE" attributeType="8" clientKey=""
                    columnSizeType="ROWS" dummyAnswer="true"
                    groupId="10" key="#2_10" labelFontSize="SMALL"
                    nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="8"
                    sortAnswerItemsByClientKey="false"
                    timerBasedScreenValueChangeEvent="false" valueFontSize="SMALL">
                    <text>Notes</text>
                </answer>
                <answer action="NONE" attributeType="9"
                    dummyAnswer="false" key="#2_21" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="9"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text/>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="8" clientKey="2_11"
                    columnSizeType="ROWS" dummyAnswer="false"
                    key="#2_11" labelFontSize="SMALL"
                    nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="10"
                    sortAnswerItemsByClientKey="false"
                    timerBasedScreenValueChangeEvent="false" valueFontSize="SMALL">
                    <text>ETA: %plcETA% (Duration %plcDuration% m)</text>
                </answer>
                <answer action="NONE" attributeType="14"
                    clientKey="2_12" columnSizeType="ROWS"
                    dummyAnswer="false" key="#2_12"
                    labelAlignment="CENTER" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="SYNCHRONOUS"
                    position="11" sortAnswerItemsByClientKey="false"
                    timerBasedScreenValueChangeEvent="false"
                    valueAlignment="CENTER" valueFontSize="SMALL">
                    <text>%plcStartLabel% %plcStart%</text>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="14"
                    clientKey="2_13" columnSizeType="ROWS"
                    dummyAnswer="false" key="#2_13"
                    labelAlignment="CENTER" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="SYNCHRONOUS"
                    position="12" sortAnswerItemsByClientKey="false"
                    timerBasedScreenValueChangeEvent="false"
                    valueAlignment="CENTER" valueFontSize="SMALL">
                    <text>%plcFinishLabel% %plcFinish%</text>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="14"
                    clientKey="2_35" columnSizeType="ROWS"
                    dummyAnswer="false" horGroupId="23"
                    horGroupItemFillViewport="NONE" horGroupItemPos="3"
                    horGroupItemWidth="10" icon="26" key="#2_35"
                    labelAlignment="CENTER" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="SYNCHRONOUS"
                    position="14" sortAnswerItemsByClientKey="false"
                    timerBasedScreenValueChangeEvent="false" valueAlignment="CENTER">
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="2" clientKey="2_16"
                    columnSizeType="ROWS" dummyAnswer="false"
                    horGroupId="23" horGroupItemFillViewport="NONE"
                    horGroupItemPos="1" horGroupItemWidth="10"
                    key="#2_16" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="14"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>Extra KMs</text>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="33" clientKey=""
                    dummyAnswer="false" horGroupAlignment="LEFT"
                    horGroupId="31" key="#2_31" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="15"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="8" clientKey=""
                    colIndex="0" columnSizeType="ROWS"
                    dummyAnswer="true" horGroupId="31"
                    horGroupItemFillViewport="NONE" horGroupItemPos="3"
                    horGroupItemWidth="10" key="#2_34"
                    labelAlignment="CENTER" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="15"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>Action</text>
                </answer>
                <answer action="NONE" attributeType="6" clientKey="2_17"
                    columnSizeType="ROWS" dummyAnswer="false"
                    horGroupId="23"
                    horGroupItemFillViewport="STRETCHITEM"
                    horGroupItemPos="2" horGroupItemWidth="1"
                    key="#2_17" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="15"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <item clientKey="KM1" dummyAnswerItem="true">
                        <value>Dummy</value>
                    </item>
                    <text>Explanation</text>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="8" clientKey=""
                    colIndex="0" columnSizeType="ROWS"
                    dummyAnswer="true" horGroupId="31"
                    horGroupItemFillViewport="STRETCHITEM"
                    horGroupItemPos="2" horGroupItemWidth="1"
                    key="#2_33" labelAlignment="LEFT"
                    nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="15"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>Explanation</text>
                </answer>
                <answer action="NONE" attributeType="8" clientKey=""
                    colIndex="0" columnSizeType="ROWS"
                    dummyAnswer="true" horGroupId="31"
                    horGroupItemFillViewport="NONE" horGroupItemPos="1"
                    horGroupItemWidth="10" key="#2_32"
                    labelAlignment="LEFT" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="15"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>Extra KMs</text>
                </answer>
                <answer action="NONE" attributeType="33" clientKey=""
                    dummyAnswer="false" horGroupAlignment="LEFT"
                    horGroupId="23" key="#2_23" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="16"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="8"
                    columnSizeType="ROWS" dummyAnswer="true"
                    horGroupId="39" horGroupItemFillViewport="NONE"
                    horGroupItemPos="1" horGroupItemWidth="10"
                    key="#2_36" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="16"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text/>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="8"
                    columnSizeType="ROWS" dummyAnswer="true"
                    horGroupId="39"
                    horGroupItemFillViewport="STRETCHITEM"
                    horGroupItemPos="2" horGroupItemWidth="1"
                    key="#2_37" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="16"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text/>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="14"
                    columnSizeType="ROWS" dummyAnswer="true"
                    horGroupId="39" horGroupItemFillViewport="NONE"
                    horGroupItemPos="3" horGroupItemWidth="10" icon="6"
                    key="#2_38" labelAlignment="CENTER"
                    nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="SYNCHRONOUS"
                    position="16" sortAnswerItemsByClientKey="false"
                    timerBasedScreenValueChangeEvent="false" valueAlignment="CENTER">
                    <text/>
                </answer>
                <answer action="NONE" attributeType="33"
                    dummyAnswer="true" horGroupAlignment="LEFT"
                    horGroupId="39" key="#2_39" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="16"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text/>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="8"
                    columnSizeType="ROWS" dummyAnswer="true"
                    horGroupId="45" horGroupItemFillViewport="NONE"
                    horGroupItemPos="1" horGroupItemWidth="10"
                    key="#2_42" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="16"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text/>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="8"
                    columnSizeType="ROWS" dummyAnswer="true"
                    horGroupId="45"
                    horGroupItemFillViewport="STRETCHITEM"
                    horGroupItemPos="2" horGroupItemWidth="1"
                    key="#2_43" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="16"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text/>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="14"
                    columnSizeType="ROWS" dummyAnswer="true"
                    horGroupId="45" horGroupItemFillViewport="NONE"
                    horGroupItemPos="3" horGroupItemWidth="10" icon="6"
                    key="#2_44" labelAlignment="CENTER"
                    nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="SYNCHRONOUS"
                    position="16" sortAnswerItemsByClientKey="false"
                    timerBasedScreenValueChangeEvent="false" valueAlignment="CENTER">
                    <text/>
                </answer>
                <answer action="NONE" attributeType="33"
                    dummyAnswer="true" horGroupAlignment="LEFT"
                    horGroupId="45" key="#2_45" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="16"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text/>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="6" clientKey="2_20"
                    columnSizeType="LEFT" dummyAnswer="false"
                    groupId="22" key="#2_20" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="SYNCHRONOUS"
                    position="17" sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <item clientKey="Client not home" dummyAnswerItem="false">
                        <value>Client not home</value>
                    </item>
                    <item clientKey="Client cancelled on arrival" dummyAnswerItem="false">
                        <value>Client cancelled on arrival</value>
                    </item>
                    <item clientKey="Appointment went over time" dummyAnswerItem="false">
                        <value>Appointment went over time</value>
                    </item>
                    <item clientKey="Client incident" dummyAnswerItem="false">
                        <value>Client incident</value>
                    </item>
                    <text>Choose a remark</text>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="0" clientKey="2_19"
                    columnSizeType="LEFT" dummyAnswer="false"
                    groupId="22" key="#2_19" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="18"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>Remark</text>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="33"
                    clientKey="2_22" dummyAnswer="false" groupId="22"
                    key="#2_22" nextQuestionKey="20"
                    onScreenValueChangeEventTrigger="NONE" position="19"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>Remarks</text>
                    <predefinedValue/>
                </answer>
                <restriction nextQuestionKey="12" position="0">
                    <condition>isAnswerSelectedByClientKey($answer:'#2_15', '2_15')</condition>
                    <matchingAssignment>showProgress('Launching Navigation');</matchingAssignment>
                </restriction>
                <restriction nextQuestionKey="8" position="1">
                    <condition>isAnswerSelectedByClientKey($answer:'#2_12', '2_12')</condition>
                    <matchingAssignment/>
                </restriction>
                <restriction nextQuestionKey="9" position="2">
                    <condition>isAnswerSelectedByClientKey($answer:'#2_13', '2_13')</condition>
                    <matchingAssignment/>
                </restriction>
                <restriction nextQuestionKey="2" position="3">
                    <condition>$local:refresh</condition>
                    <matchingAssignment>$local:refresh = false;</matchingAssignment>
                </restriction>
                <restriction nextQuestionKey="20" position="4">
                    <condition>$local:cal</condition>
                    <matchingAssignment/>
                </restriction>
                <restriction nextQuestionKey="20" position="6">
                    <condition>$local:tasklist</condition>
                    <matchingAssignment/>
                </restriction>
                <onEnterAssignment>

clearAnswerValues();
varDuration 	= 30;
$local:Commit	= true;

setOkText('Save');

setAnswerBackground($answer:'#2_40', '2_40', '#FFFFFF');
setAnswerBackground($answer:'#2_41', '2_41', '#FFFFFF');

// Read master data by key
$local:key = $global:selAppt['key'];

//------------------------------------------------------------------------------------------------
// Set the answer values
sep = ', ';


// Name and address
ClientName 		= $global:selAppt['filter1'];
ClientAddress 	= $global:selAppt['data']['addressStreet'];

//------------------------------------------------------------------------------------------------
// Placeholders
setPlaceholder('%plcName%', ClientName);	
setPlaceholder('%plcAddress%', ClientAddress);	
setPlaceholder('%plcType%', $global:selAppt['data']['type']);	
setPlaceholder('%plcReference%', $global:selAppt['data']['reference']);	
setPlaceholder('%plcLocation%', $global:selAppt['data']['city']);

//------------------------------------------------------------------------------------------------
// Times for use in drill down screens

// 1 - From 'times' pool
if ($local:mdTimes == null)
{
	$local:mdTimes = getMasterData($masterdata:'times', $local:key);
}
call($local:AppTimes)();

setPlaceholder('%plcStart%', $global:arrAppt['StartTime']);	
setPlaceholder('%plcFinish%', $global:arrAppt['FinishTime']);	
setPlaceholder('%plcETA%', $global:arrAppt['StartTime']);	
varDate = $global:arrAppt['StartTmStmp'];
$global:arrAppt['startTimestamp'] = dateToTimestamp(varDate);
varDate = $global:arrAppt['FinishTmStmp'];
$global:arrAppt['finishTimestamp'] = dateToTimestamp(varDate);
$global:arrAppt['Duration'] = ($global:arrAppt['finishTimestamp'] - $global:arrAppt['startTimestamp']) / 60000;
$global:arrAppt['DurInt'] = numberFormat('*', $global:arrAppt['Duration']);
setPlaceholder('%plcDuration%', $global:arrAppt['DurInt']);	

setAnswerValueByClientKey($answer:'#2_19', '2_19', $global:arrAppt['Remark']);	

//------------------------------------------------------------------------------------------------
// Email
if ($global:selAppt['data']['email'] != '')
{
	setAnswerValueByClientKey($answer:'#2_40', '2_40', $global:selAppt['data']['email']);
}
else
{
	removeAnswerByClientKey($answer:'#2_40', '2_40');
}

// Phone
if ($global:selAppt['data']['phone'] != '')
{
	setAnswerValueByClientKey($answer:'#2_41', '2_41', $global:selAppt['data']['phone']);
}
else
{
	removeAnswerByClientKey($answer:'#2_41', '2_41');
}

//------------------------------------------------------------------------------------------------
// Extra KMs (array)
if ($local:mdKMs == null)
{
	$local:mdKMs = getMasterData($masterdata:'extraKm', $local:key);
}

// Add new answers
$local:kmgroup = 70;
for (l : $local:mdKMs['data'])
{

	if (($local:mdKMs['data'][l]['KMs'] != '') ?and ($local:mdKMs['data'][l]['KMs'] != null))
	{
			
		$local:kmgroup 	= $local:kmgroup + 1;
		arrVal			= strTokenArray(l, '_');
		kmCount			= arrVal[1];
	
		clientKey = concat('2_39_', kmCount);
		$local:ansKM[clientKey] = '';
		$local:ansKM[clientKey]['answer'] 		= '2_39';
		$local:ansKM[clientKey]['clientkey'] 	= clientKey;
		addAnswer($answer:'#2_39', clientKey, '');
		setHorGroupId($answer:'#2_39', clientKey, $local:kmgroup);
		
		varKMs = $local:mdKMs['data'][l]['KMs'];
		clientKey = concat('2_36_', kmCount);
		$local:ansKM[clientKey] = '';
		$local:ansKM[clientKey]['answer'] 		= '2_36';
		$local:ansKM[clientKey]['clientkey'] 	= clientKey;		
		addAnswer($answer:'#2_36', clientKey, varKMs);
		setHorGroupId($answer:'#2_36', clientKey, $local:kmgroup);
			
		varExpl = $local:mdKMs['data'][l]['Exp'];
		clientKey = concat('2_37_', kmCount);
		$local:ansKM[clientKey] = '';
		$local:ansKM[clientKey]['answer'] 		= '2_37';
		$local:ansKM[clientKey]['clientkey'] 	= clientKey;
		addAnswer($answer:'#2_37', clientKey, $global:cfgExtraKMs[varExpl]);
		setHorGroupId($answer:'#2_37', clientKey, $local:kmgroup);
		
		clientKey = concat('2_38_', kmCount);
		$local:ansKM[clientKey] = '';
		$local:ansKM[clientKey]['answer'] 		= '2_38';
		$local:ansKM[clientKey]['clientkey'] 	= clientKey;
		addAnswer($answer:'#2_38', clientKey, '');
		setHorGroupId($answer:'#2_38', clientKey, $local:kmgroup);	
		setButtonColors($answer:'#2_38', clientKey, '#ffffff', '#ffffff', '#258fc3');
	
	}		
}

//------------------------------------------------------------------------------------------------
// Notes (array)
$local:arrNotes = null;
$local:arrNotes	= $global:selAppt['data']['comments'];
count = 0;
for (j : $local:arrNotes)
{	
	if ($local:arrNotes[j] != '')
	{
		count = count + 1;
		group = 40 + count;	
		clientKey = concat('2_9_', count);
		addAnswer($answer:'#2_9', clientKey, j);
		setGroupid($answer:'#2_9', clientKey, group);	
		clientKey = concat('2_10_', count);
		addAnswer($answer:'#2_10', clientKey, $local:arrNotes[j]);
		setGroupid($answer:'#2_10', clientKey, group);
	}
}

//------------------------------------------------------------------------------------------------
// Location
$global:lat		= $global:selAppt['data']['lat'];
$global:long 	= $global:selAppt['data']['long'];

//------------------------------------------------------------------------------------------------
// Status

setAnswerEnabled($answer:'#2_12', '2_12', true);
setAnswerEnabled($answer:'#2_13', '2_13', false);

if ($local:mdTimes['data']['status'] == null)
{
	varStatus = $global:selAppt['data']['status'];
}
else
{
	varStatus = $local:mdTimes['data']['status'];
}
	
if (varStatus == 'started')
{
	setAnswerEnabled($answer:'#2_12', '2_12', false);
	setAnswerEnabled($answer:'#2_13', '2_13', true);
	setPlaceholder('%plcStartLabel%', 'STARTED @');
	setPlaceholder('%plcFinishLabel%', 'FINISH');		
}

if (varStatus == 'finished')
{
	setAnswerEnabled($answer:'#2_12', '2_12', false);
	setAnswerEnabled($answer:'#2_13', '2_13', false);
	setPlaceholder('%plcStartLabel%', 'STARTED @');
	setPlaceholder('%plcFinishLabel%', 'FINISHED @');	
}

if (varStatus == 'mutable')
{
	setPlaceholder('%plcFinishLabel%', 'FINISH');
	setPlaceholder('%plcStartLabel%', 'START');	
}

// Can this task be realized
if ($local:RLZ[$global:selAppt['data']['shiftId']][$global:selAppt['data']['realisationGroup']][$global:selAppt['data']['realisationGroupSequence']]['rlz'] == false) 
{
	setAnswerEnabled($answer:'#2_12', '2_12', false);
	setAnswerEnabled($answer:'#2_13', '2_13', false);
}	
	

//------------------------------------------------------------------------------------------------
// interaction configuration
arrint = $global:cfginteraction[$global:selAppt['data']['interaction']];
if (arrint['remarks'] == '')
{
	removeAnswerByClientKey($answer:'#2_19', '2_19');
	removeAnswerByClientKey($answer:'#2_20', '2_20');
	removeAnswerByClientKey($answer:'#2_22', '2_22');
}
arrint = $global:cfginteraction[$global:selAppt['data']['interaction']];
if (arrint['extrakms'] == '')
{
	removeAnswerByClientKey($answer:'#2_16', '2_16');
	removeAnswerByClientKey($answer:'#2_17', '2_17');
	removeAnswerByClientKey($answer:'#2_35', '2_35');	
	removeAnswerByClientKey($answer:'#2_31', '2_31');	
	removeAnswerByClientKey($answer:'#2_32', '2_32');	
	removeAnswerByClientKey($answer:'#2_33', '2_33');	
	
}
else
{
	addAnsweritems($answer:'#2_17', '2_17', 'KM1', $global:cfgExtraKMs);
}

//------------------------------------------------------------------------------------------------
// Button Colours
setButtonColors($answer:'#2_15', '2_15', '#ffffff', '#ffffff', '#258fc3');	//navigation
setButtonColors($answer:'#2_12', '2_12', '#8fbb3f', '#9ab963', '#8fbb3f');	//start time
setButtonColors($answer:'#2_13', '2_13', '#258fc3', '#5da3c6', '#258fc3');	//finish time
setButtonColors($answer:'#2_35', '2_35', '#ffffff', '#ffffff', '#258fc3');	//add kms entry
</onEnterAssignment>
                <onLeaveOkPrepareAssignment>

//Remarks
$global:arrAppt['remarks']	= getAnswerValueByClientKey($answer:'#2_19', '2_19');
if ($global:arrAppt['remarks'] != '')
{
	if ($global:arrAppt['remarks'] != $global:selAppt['data']['remark'])
	{
		$global:selAppt['data']['remark'] = $global:arrAppt['remarks'];
		$local:mdTimes['data']['remarks'] = $global:arrAppt['remarks'];	
		$local:Update = true;
	}
}

</onLeaveOkPrepareAssignment>
                <onLeaveOkPersistAssignment>

	if ($local:Commit == true)
	{

		// 	Update the times table
		if (($local:Update == 'true') ?and ($local:mdTimes != null))
		{			
			updateMasterData($masterdata:'times', $local:mdTimes, true, true, true);
		}

		// 	Update the extraKMs table
		if (($local:Update == 'true') ?and ($local:mdKMs != null))
		{
			mdextraKMs = getMasterData($masterdata:'extraKm', $local:key);		
			mdextraKMs['data'] 	= $local:mdKMs['data'];
			updateMasterData($masterdata:'extraKm', mdextraKMs, true, true, true);
		}

    	clearAnswerValues();
    	$global:arrAppt 	= null;
    	$local:mdTasks 		= null;
		$global:startTime 	= null;
		$global:finishTime 	= null;
		$global:remarks 	= null;
		$local:mdTimes		= null;
		$local:ansKM		= null;
		$local:mdKMs		= null;
		$local:Update		= false;
		$global:selAppt		= null;
		//triggerBackEvent();
}
	
</onLeaveOkPersistAssignment>
                <onLeaveBackAssignment>

//	Clear all used variables
    clearAnswerValues();
    $global:arrAppt 	= null;
    $local:mdTasks 		= null;
	$global:startTime 	= null;
	$global:finishTime 	= null;
	$global:remarks 	= null;
	$local:mdTimes		= null;
	$local:ansKM		= null;
	$local:mdKMs		= null;
	$local:Update		= false;
	$global:selAppt		= null;
	
</onLeaveBackAssignment>
                <onScreenValueChangeEvent>

function(answerKey, clientKey, value, data)
{    
	branch = 0;

	if (clientKey == '2_20')			// add remarks
	{
		branch = 1;
	}
	if (clientKey == '2_35')			// add kms row
	{
		branch = 2;
	}
	if (answerKey == $answer:'#2_38')	// delete kms row
	{
		branch = 3;
	}
	if (clientKey == '2_40')			// email
	{
		branch = 4;
	}
	if (clientKey == '2_41')			// phone
	{
		branch = 4;
	}
	if (clientKey == '2_15')			// navigate
	{
		branch = 4;
	}
	if (clientKey == '2_12')			// start
	{
		branch = 4;
	}			
	if (clientKey == '2_13')			// finish
	{
		branch = 4;
	}	
	
	if ($local:count == null)
	{
		$local:count = 0;
	}
	
	switch (branch)
	{
		case 1 :
		{
			setAnswerValueByClientKey($answer:'#2_19', '2_19', value);	
		}
		case 2 :
		{
			varKms = getAnswerValueByClientKey($answer:'#2_16', '2_16');
			if (varKms != '')
			{
				$local:Update	= 'true';
			
				// Add an entry to the local KMs array
				varCount = count($local:mdKMs['data']);
				varCount = varCount + 1;
				kmKey = concat($global:selAppt['data']['stopId'], '_', varCount);				
				$local:mdKMs['data'][kmKey]['KMs'] 	= varKms;
				$local:mdKMs['data'][kmKey]['Exp'] 	= getAnswerValueByClientKey($answer:'#2_17', '2_17');
				$local:refresh 	= true; 
				$local:Commit	= false;
				triggerOkEvent(); 
								
			}
		}
		case 3 :
		{
			$local:Update	= 'true';
		
			// Remove an entry from the local KMs array
			arrVal			= strTokenArray(clientKey, '_');
			row 			= arrVal[2];
			kmKey			= concat($global:selAppt['data']['stopId'], '_', row);			
			$local:mdKMs['data'][kmKey]['KMs'] 	= null;

            varClientKey = concat('2_36_', row);
            removeAnswerByClientKey($answer:'#2_36', varClientKey);
            varClientKey = concat('2_37_', row);
            removeAnswerByClientKey($answer:'#2_37', varClientKey);
            varClientKey = concat('2_38_', row);
            removeAnswerByClientKey($answer:'#2_38', varClientKey);
            varClientKey = concat('2_39_', row);
            removeAnswerByClientKey($answer:'#2_39', varClientKey);
            
			$local:refresh	= true; 
			$local:Commit 	= false;				
			triggerOkEvent(); 

		}
		case 4 :
		{
			$local:Commit = false;
			triggerOkEvent(); 
		}
	}
	
}
</onScreenValueChangeEvent>
                <onExternalEvent/>
            </question>
//---------------------------------------------------------------------------------------               
// Tasklist
//---------------------------------------------------------------------------------------    
            <question backNavigationAllowed="true" groupColumnIndex="0"
                key="6" sortColumnIndex="5" tableOptionsEnabled="false"
                tableRowDetailsEnabled="false" title="Tasklist" type="16">
                <answer action="NONE" attributeType="72"
                    dummyAnswer="false" key="#6_1" nextQuestionKey="10"
                    onScreenValueChangeEventTrigger="NONE" position="0"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text/>
                </answer>
                <answer action="NONE" attributeType="-128" clientKey="0"
                    colIndex="0" colSearchable="false"
                    dummyAnswer="true" key="#6_2" nextQuestionKey="END"
                    onScreenValueChangeEventTrigger="NONE" position="1"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text/>
                </answer>
                <answer action="NONE" attributeType="-116" clientKey="0"
                    colIndex="1" colSearchable="false" colWidth="3"
                    dummyAnswer="true" icon="-1" key="#6_3"
                    nextQuestionKey="1"
                    onScreenValueChangeEventTrigger="NONE" position="2"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text/>
                </answer>
                <answer action="NONE" attributeType="8" clientKey="0"
                    colIndex="3" colWidth="15" dummyAnswer="true"
                    key="#6_6" nextQuestionKey="END"
                    onScreenValueChangeEventTrigger="NONE" position="3"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text/>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="-120" clientKey="0"
                    colIndex="2" colSearchable="false"
                    dummyAnswer="true" key="#6_4" nextQuestionKey="1"
                    onScreenValueChangeEventTrigger="NONE" position="4"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text/>
                </answer>
                <answer action="NONE" attributeType="32" clientKey="0"
                    colIndex="4" dummyAnswer="true" key="#6_5"
                    nextQuestionKey="21"
                    onScreenValueChangeEventTrigger="NONE" position="5"
                    sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text/>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="-120" clientKey="0"
                    colIndex="5" colSearchable="false" colWidth="0"
                    dummyAnswer="true" key="#6_7" nextQuestionKey="1"
                    onScreenValueChangeEventTrigger="NONE" position="6"
                    sortAnswerItemsByClientKey="false"
                    timerBasedScreenValueChangeEvent="false" valueFontColor="#FFFFFF">
                    <text/>
                </answer>
                <onEnterAssignment>
// Current system timestamp
oneDay 			= 84600000;          
CurrentTime 	= systemTime() - oneDay;  
$local:Update 	= false;
$local:RLZ		= null;


// Get masterdata
$local:mdTasks = queryMasterData($masterdata:'action', $global:device, filterConfig, {'result' : 'all';});

//--------------------------------------------------------------------------------
// Load tasks
arrTaskList = null;
taskDate 	= null;

for (i : $local:mdTasks)
{

	$local:mdTimes = getMasterData($masterdata:'times', i);
	$local:key = i;
	call($local:AppTimes)();
	
	// Status
	if ($local:mdTimes['data']['status'] == null)
	{
		varStatus = $local:mdTasks[$local:key]['data']['status'];
	}
	else
	{
		varStatus = $local:mdTimes['data']['status'];
	}
		
	// Less than today then skip
	if (varStatus != 'started')
	{
		ApptTime = dateToTimestamp($global:arrAppt['StartTmStmp'], true);
		if (ApptTime &lt; CurrentTime)
		{ 
			$local:mdTimes 	= null;
			$local:key 		= null;
			$global:arrAppt = null;		
			continue;
		}
	}

	// Interaction configuration
	intKey = $local:mdTasks[i]['data']['interaction'];
	arrInt = $global:cfgInteraction[intKey];
	if (arrInt['tasklist'] != 'X')
	{
		$local:mdTimes 	= null;
		$local:key 		= null;
		$global:arrAppt = null;
		continue;
	}
	
	TimeStamp 	= $global:arrAppt['StartTmStmp']; 	
	stringDate 	= substring(TimeStamp, 0, 10);
	call($local:LongDate)(stringDate, varLongDate);
	varSorti	= datetotimestamp(TimeStamp);

	arrTaskList[varSorti]['header'] 			= varLongDate;
	arrTaskList[varSorti]['clientKey'] 			= i;
	arrTaskList[varSorti]['icon'] 				= '119';
	arrTaskList[varSorti]['realisationGroup'] 	= $local:mdTasks[i]['data']['realisationGroup'];
	
	if (varStatus == 'started')
	{ 
		arrTaskList[varSorti]['icon'] 	= '117';
	}

	if (varStatus == 'finished')
	{ 
		arrTaskList[varSorti]['icon'] 	= '113';
	}
	
	if (intKey == 'info-tasklist')
	{
		arrTaskList[varSorti]['icon'] 	= '118';	
	}
	
	arrTaskList[varSorti]['description'] 	= concat($global:arrAppt['StartTime'], ' - ', $global:arrAppt['FinishTime']);
	arrTaskList[varSorti]['name'] 			= $local:mdTasks[i]['filter1']; 
	arrTaskList[varSorti]['location'] 		= $local:mdTasks[i]['filter2'];
	arrTaskList[varSorti]['shift'] 			= $local:mdTasks[i]['data']['shiftId'];
	arrTaskList[varSorti]['group'] 			= $local:mdTasks[i]['data']['realisationGroup'];
	arrTaskList[varSorti]['seq'] 			= $local:mdTasks[i]['data']['realisationGroupSequence'];

	if (arrInt['taskdetail'] == 'X')
	{
		arrTaskList[varSorti]['sel'] = 'X';
	}
	
	taskDate = $global:arrAppt['StartTmStmp'];
	
	if ((substring($local:mdTasks[i]['data']['interaction'], 0, 4) == 'task') ?and ($local:mdTasks[$local:key]['data']['realisationGroupSequence'] != null))
	{
		$local:RLZ[$local:mdTasks[$local:key]['data']['shiftId']][$local:mdTasks[$local:key]['data']['realisationGroup']][$local:mdTasks[$local:key]['data']['realisationGroupSequence']]['task'] 	= $local:key;
		$local:RLZ[$local:mdTasks[$local:key]['data']['shiftId']][$local:mdTasks[$local:key]['data']['realisationGroup']][$local:mdTasks[$local:key]['data']['realisationGroupSequence']]['rlz'] 	= false;
		$local:RLZ[$local:mdTasks[$local:key]['data']['shiftId']][$local:mdTasks[$local:key]['data']['realisationGroup']][$local:mdTasks[$local:key]['data']['realisationGroupSequence']]['status']	= varStatus;
	}
		
	$local:mdTimes 	= null;
	$local:key 		= null;
	$global:arrAppt = null;
}

	result = call($local:NextRlz)();	

//--------------------------------------------------------------------------------
// Add tasks to task list screen
count 		= 0;
savedHeader = '';

$local:TaskList = arrTaskList;		//save for later
forasc (j : arrTaskList)
{

	if (savedHeader != arrTaskList[j]['header'])
	{
		count 		= count + 1;
		countint 	= numberFormat('*', count);
		varHeader 	= concat(countint, ' - ', arrTaskList[j]['header']);
	}

	addAnswer($answer:'#6_2', j, varHeader);	

	addAnswer($answer:'#6_3', j, ''); 
	setAnswerIconByClientKey($answer:'#6_3', j, arrTaskList[j]['icon']); 

	addAnswer($answer:'#6_4', j, ''); 
	setAnswerValueByClientKey($answer:'#6_4', j, arrTaskList[j]['name']);
	setValueInfoText($answer:'#6_4', j, arrTaskList[j]['location']);
	setValueInfoFont($answer:'#6_4', j, 0, 0);				//small
	setValueInfoFontColor($answer:'#6_4', j, '#B0B0B0');	//grey
	addAnswer($answer:'#6_7', j, '');	//sort column	
	setAnswerValueByClientKey($answer:'#6_7', j, j);
		
	if (arrTaskList[j]['sel'] == 'X')
	{
		addAnswer($answer:'#6_5', j, '');	//row selector			
		addAnswer($answer:'#6_6', j, ''); 	//description
		setAnswerValueByClientKey($answer:'#6_6', j, arrTaskList[j]['description']);	
	}

	// Background Colour for next selectable
	if ($local:RLZ[arrTaskList[j]['shift']][arrTaskList[j]['group']][arrTaskList[j]['seq']]['rlz'] == true)
	{ setTableRowBackgroundColor(j, '#EFF0F4');	}

	savedHeader = arrTaskList[j]['header'];
}
</onEnterAssignment>
                <onLeaveOkPrepareAssignment>
                
	// Save selected appointment
	row 		= getQuestionClientKey();
	clientKey 	= $local:TaskList[row]['clientKey'];
	$global:selAppt = getMasterData($masterdata:'action', clientKey); 

</onLeaveOkPrepareAssignment>
                <onLeaveOkPersistAssignment/>
                <onLeaveBackAssignment/>
            </question>
//---------------------------------------------------------------------------------------               
// Start Time Entry
//---------------------------------------------------------------------------------------             
			<question backNavigationAllowed="true" key="8"
                sortAnswersByClientKey="false"
                tableOptionsEnabled="true" tableRowDetailsEnabled="true"
                title="Start Time Entry" type="5">
                <answer action="NONE" attributeType="67"
                    clientKey="StartTime" colIndex="0"
                    dummyAnswer="false" key="#8_1" nextQuestionKey="2"
                    onScreenValueChangeEventTrigger="SYNCHRONOUS"
                    position="0" sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>Start time</text>
                </answer>
                <answer action="NONE" attributeType="14"
                    dummyAnswer="false" icon="3" key="#8_2"
                    nextQuestionKey="2"
                    onScreenValueChangeEventTrigger="SYNCHRONOUS"
                    position="1" sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>Current Time</text>
                    <predefinedValue/>
                </answer>
                <validation backwardNavigation="false" position="1" type="ERROR">
                    <condition>$local:FutureERR
         		</condition>
                    <text>Time selected must not be in the future</text>
                    <matchingAssignment/>
                </validation>
                <onEnterAssignment>
                //yyyy-mm-ddThh:mm
                newTmStmp 	= substring($global:arrAppt['StartTmStmp'], 0, 16);
                setAnswerValueByClientKey($answer:'#8_1', 'StartTime', newTmStmp);
				$local:FutureERR 	= false;
				</onEnterAssignment>
                <onLeaveOkPrepareAssignment>
                
		sysTime = systemTime();
		call($local:convertTimestampToDatetime)(sysTime);                
		$local:FutureERR = false;
       	newtime 	= getAnswerValueByClientKey($answer:'#8_1', 'StartTime');
		call($local:FutureTimeCheck)(sysTime, newtime);
		                
        if ($local:FutureERR == false)
        {
			$local:Update = true;
			$global:arrAppt['StartTmStmp'] = getAnswerValueByClientKey($answer:'#8_1', 'StartTime');
			$local:mdTimes['data']['realizedstarttime']	= $global:arrAppt['StartTmStmp'];						
			$local:mdTimes['data']['status'] = 'started';
    		$global:selAppt['status'] = $local:mdTimes['data']['status'];
    		$local:RlzTask = $local:clientKey;
    	}
    			</onLeaveOkPrepareAssignment>
                <onLeaveBackAssignment/>
                <onScreenValueChangeEvent>
	function(answerKey, clientKey, value, data)
	{ 
	
		sysTime = systemTime();
		call($local:convertTimestampToDatetime)(sysTime);

		if (answerKey == $answer:'#8_2')	//Set current time on screen
		{			
            setAnswerValueByClientKey($answer:'#8_1', 'StartTime', sysTime);
        }
                
		$local:FutureERR = false;
       	newtime 	= getAnswerValueByClientKey($answer:'#8_1', 'StartTime');
		call($local:FutureTimeCheck)(sysTime, newtime);
                       
	}
	</onScreenValueChangeEvent>
                <onExternalEvent/>
            </question>
//---------------------------------------------------------------------------------------               
// Finish Time Entry
//---------------------------------------------------------------------------------------             
            <question backNavigationAllowed="true" key="9"
                sortAnswersByClientKey="false"
                tableOptionsEnabled="true" tableRowDetailsEnabled="true"
                title="Finish Time Entry" type="5">
                <answer action="NONE" attributeType="67"
                    clientKey="FinishTime" dummyAnswer="false"
                    key="#9_2" nextQuestionKey="2"
                    onScreenValueChangeEventTrigger="SYNCHRONOUS"
                    position="0" sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>Finish Time</text>
                    <predefinedValue/>
                </answer>
                <answer action="NONE" attributeType="14"
                    dummyAnswer="false" icon="3" key="#9_3"
                    nextQuestionKey="2"
                    onScreenValueChangeEventTrigger="SYNCHRONOUS"
                    position="1" sortAnswerItemsByClientKey="false" timerBasedScreenValueChangeEvent="false">
                    <text>Current Time</text>
                    <predefinedValue/>
                </answer>
                <validation backwardNavigation="false" position="0" type="ERROR">
                    <condition>$local:TimeERR
         		</condition>
                    <text>Finish time must not be earlier than start time</text>
                    <matchingAssignment/>
                </validation>
                <validation backwardNavigation="false" position="1" type="ERROR">
                    <condition>$local:FutureERR
         		</condition>
                    <text>Time selected must not be in the future</text>
                    <matchingAssignment/>
                </validation>
                <onEnterAssignment>
                //yyyy-mm-ddThh:mm
                	newTmStmp 	= substring($global:arrAppt['FinishTmStmp'], 0, 16);
                	setAnswerValueByClientKey($answer:'#9_2', 'FinishTime', newTmStmp);
					$local:TimeERR 		= false;
					$local:FutureERR 	= false;
				</onEnterAssignment>
                <onLeaveOkPrepareAssignment>
		
		sysTime 			= systemTime();
    	call($local:convertTimestampToDatetime)(sysTime);
    	$local:FutureERR 	= false;
       	newtime 			= getAnswerValueByClientKey($answer:'#9_2', 'FinishTime');
		NewTStamp   		= dateToTimestamp(newtime, true); 
        CrrntTStamp 		= dateToTimestamp(sysTime, true);      
        if (NewTStamp &gt; CrrntTStamp)
        {
          	$local:FutureERR = true;
        } 
         
       	$local:TimeERR = false;	//Cannot be before start time       	
        if (NewTStamp &lt; $global:arrAppt['startTimestamp'])
        {
           	$local:TimeERR = true;
        }       
		        
        if (($local:TimeERR == false) ?and ($local:FutureERR == false))
        {
			$local:Update = true;
			$global:arrAppt['FinishTmStmp'] = getAnswerValueByClientKey($answer:'#9_2', 'FinishTime');
			$local:mdTimes['data']['realizedfinishtime'] 	= $global:arrAppt['FinishTmStmp'];						
			$local:mdTimes['data']['status'] = 'finished';
    		$global:selAppt['status'] = $local:mdTimes['data']['status'];
    		$local:RlzTask = null;    			    				    			
    	}
    		</onLeaveOkPrepareAssignment>
                <onLeaveOkPersistAssignment/>
                <onLeaveBackAssignment/>
                <onScreenValueChangeEvent>
	function(answerKey, clientKey, value, data)
	{ 
		sysTime = systemTime();
    	call($local:convertTimestampToDatetime)(sysTime);
              
		if (answerKey == $answer:'#9_3')
		{
            setAnswerValueByClientKey($answer:'#9_2', 'FinishTime', sysTime);
        }

		$local:FutureERR = false;
       	newtime 	= getAnswerValueByClientKey($answer:'#9_2', 'FinishTime');
		NewTStamp   = dateToTimestamp(newtime, true); 
        CrrntTStamp = dateToTimestamp(sysTime, true);      
        if (NewTStamp &gt; CrrntTStamp)
        {
          	$local:FutureERR = true;
        } 
         
       	$local:TimeERR = false;	//Cannot be before start time       	
        if (NewTStamp &lt; $global:arrAppt['startTimestamp'])
        {
           	$local:TimeERR = true;
        }
                        
	}	
	</onScreenValueChangeEvent>
                <onExternalEvent/>
            </question>
//---------------------------------------------------------------------------------------               
// Call Intermovelet
//---------------------------------------------------------------------------------------             
            <question intermoveletMoveletKey="ORTEC_BC_INT_v1.1"
                key="20" type="40">
                <answer key="#20_1" nextQuestionKey="END">
                	<text>Upload sync failed. Please sync manually</text>
                </answer>
                <restriction nextQuestionKey="1">
                    <condition>$local:cal</condition>
                </restriction>
                <restriction nextQuestionKey="6">
                    <condition>$local:tasklist</condition>
                </restriction>
            </question>
//---------------------------------------------------------------------------------------               
// Call Intermovelet
//---------------------------------------------------------------------------------------             
            <question intermoveletMoveletKey="ORTEC_BC_INT2_v1.1"
                key="21" type="40">
                <answer key="#21_1" nextQuestionKey="2">
                	<text>Upload sync failed. Please sync manually</text>
                </answer>
            </question>
//--------------------------------------------------------------------------------------- 
             
            <syncDownloadAssignment>

$global:cfgInteraction =
{
    'none' :
    {
        'route'  		: '';	
        'calendar'  	: '';
        'tasklist'  	: '';
        'taskdetail'  	: '';
        'extrakms' 		: '';
        'remarks'  		: '';
    };
    'info-tasklist' :
    {
        'route'  		: '';	
        'calendar'  	: '';
        'tasklist'  	: 'X';
        'taskdetail'  	: '';
        'extrakms' 		: '';
        'remarks'  		: '';    };
	'task' :
    {
        'route'  		: 'X';	
        'calendar'  	: 'X';
        'tasklist'  	: 'X';
        'taskdetail'  	: 'X';
        'extrakms' 		: '';
        'remarks'  		: '';    };
	'task-bc' :
    {
        'route'  		: 'X';	
        'calendar'  	: 'X';
        'tasklist'  	: 'X';
        'taskdetail'  	: 'X';
        'extrakms' 		: 'X';
        'remarks'  		: 'X';    };
};

$global:cfgExtraKMs = 
{
	'5' : 'Social Outing';	
	'6' : 'Shopping';
	'7' : 'Appointments';
	'8' : 'Day Centre';
};

// UDF: TIMESTAMP TO DATETIME
$local:convertTimestampToDatetime = function($ref:timeToConvert)
{
timeToConvert = timestampToDateTime(timeToConvert, getCurrentTimeZoneId(), false);
};

// Check Future Time
$local:FutureTimeCheck = function($ref:SysTime, $ref:NewTime)
{
	NewTStamp 	= dateToTimestamp(NewTime, true);  	
    CrrntTStamp = dateToTimestamp(SysTime, true);       
    if (NewTStamp &gt; CrrntTStamp)
    {
    	$local:FutureERR = true;
    } 
};


$local:AppTimes = function( )
{

$global:arrAppt = null;

if ($local:mdTimes != null)
{
	if ($local:mdTimes['data']['realizedstarttime'] != null)
	{
		$global:arrAppt['StartTmStmp']	= $local:mdTimes['data']['realizedstarttime'];
	}
	if ($local:mdTimes['data']['realizedfinishtime'] != null)
	{
		$global:arrAppt['FinishTmStmp']	= $local:mdTimes['data']['realizedfinishtime'];
	}
	if ($local:mdTimes['data']['remarks'] != null)
	{
		$global:arrAppt['Remark']	= $local:mdTimes['data']['remarks'];
	}		
}

// 2 - From OSP realized
if ($global:arrAppt['StartTmStmp'] == null)
{
	if ($local:mdTasks[$local:key]['data']['realizedstarttime'] != null)
	{
		$global:arrAppt['StartTmStmp']	= $local:mdTasks[$local:key]['data']['realizedstarttime'];
	}
}
if ($global:arrAppt['FinishTmStmp'] == null)
{
	if ($local:mdTasks[$local:key]['data']['realizedfinishtime'] != null)
	{
		$global:arrAppt['FinishTmStmp']	= $local:mdTasks[$local:key]['data']['realizedfinishtime'];
	}
}

// 3 - From OSP action
if ($global:arrAppt['StartTmStmp'] == null)
{
	if ($local:mdTasks[$local:key]['data']['starttime'] != null)
	{
		$global:arrAppt['StartTmStmp'] 	= $local:mdTasks[$local:key]['data']['starttime'];	
	}
}
if ($global:arrAppt['FinishTmStmp'] == null)
{
	if ($local:mdTasks[$local:key]['data']['finishtime'] != null)
	{
		$global:arrAppt['FinishTmStmp'] = $local:mdTasks[$local:key]['data']['finishtime'];	
	}
}

if ($global:arrAppt['StartTmStmp'] != null)
{
	$global:arrAppt['StartTime'] 	= substring($global:arrAppt['StartTmStmp'], 11, 16);
}
if ($global:arrAppt['FinishTmStmp'] != null)
{ 	
	$global:arrAppt['FinishTime'] 	= substring($global:arrAppt['FinishTmStmp'], 11, 16); 
}
};

// Function to work out the next realizable task
$local:NextRlz = function( )
{

forasc (s : $local:RLZ )	//shift
{
	forasc (g : $local:RLZ[s] )		//Rlz Group
	{
		forasc (t : $local:RLZ[s][g] )		//task
		{
			found = false;
			if ($local:RLZ[s][g][t]['status'] == 'started')
			{ 
				$local:RLZ[s][g][t]['rlz'] = true; 
				found = true;
				break;
			}
		}
		if (found == true)	//realizible tasks have been found so move to next shift
		{ break; }		
	}
	if (found == true)	//realizible tasks have been found so move to next shift
	{ continue; } 
	forasc (g : $local:RLZ[s] )		//Rlz Group
	{
		forasc (t : $local:RLZ[s][g] )		//task
		{
			found = false;
			if ($local:RLZ[s][g][t]['status'] == 'mutable')
			{ 
				$local:RLZ[s][g][t]['rlz'] = true; 
				found = true;
			}
		}
		if (found == true)	//realizible tasks have been found so move to next shift
		{ break; }		
	}		
}

};

$local:LongDate = function($ref:date, $ref:LongDate)
{
// 	split date YYYY-MM-DD
    year 		= subString(date, 0, 4);
	month 		= subString(date, 5, 7);
	day 		= subString(date, 8, 10);
	
// month
    switch (month)
    {
        case 1 :
        {
            monthLong = 'Jan';
        }
        case 2 :
        {
            monthLong = 'Feb';
        }
        case 3 :
        {
            monthLong = 'Mar';
        }
        case 4 :
        {
            monthLong = 'Apr';
        }
        case 5 :
        {
            monthLong = 'May';
        }        
        case 6 :
        {
            monthLong = 'Jun';
        }
        case 7 :
        {
            monthLong = 'Jul';
        }
        case 8 :
        {
            monthLong = 'Aug';
        }
        case 9 :
        {
            monthLong = 'Sep';
        }
        case 10 :
        {
            monthLong = 'Oct';
        }
        case 11 :
        {
            monthLong = 'Nov';
        }
        case 12 :
        {
            monthLong = 'Dec';
        }
    }
    
    
    // day of the week
    dayNum =  getDayOfWeek(date);
    switch (dayNum)
    {
        case 1 :
        {
            dayLong = 'Sunday';
        }
        case 2 :
        {
            dayLong = 'Monday';
        }        
        case 3 :
        {
            dayLong = 'Tuesday';
        }        
        case 4 :
        {
            dayLong = 'Wednesday';
        }
        case 5 :
        {
            dayLong = 'Thursday';
        }    
        case 6 :
        {
            dayLong = 'Friday';
        }    
        case 7 :
        {
            dayLong = 'Saturday';
        }
    }
        
    // reassemble date
    LongDate = concat(dayLong, ', ', day, ' ', monthLong, ' ', year);
};

$global:pathfinder = function(locLat, locLong)
	{
	comma = ',';
	
                // returning the client platform which we are currently using
                getPlatform = getClientType();
  
                // returning OS information
                os = getSystemInfo(0);
  
                // modifying returned string to lower case letters, to avoid typos
                os = toLowerCase(os);
  
                // clearing url scheme definition
                urlScheme = '';
  
                switch(getPlatform)
                  {
                    // Android
                    case 10:
                    case 11:
                    {
                         urlScheme = '%com.google.android.apps.maps%google.navigation://';
                         params = conCat('?q=', locLat, comma, locLong);
                          id = connect(conCat('exec://', urlScheme, params), null);
                    }
  
                    // Windows Phone
                    case 22:
                    {
                        urlScheme = 'bingmaps:?cp=';
                        params = concat(locLat, '~', locLong);
                        id = connect(conCat('exec:', urlScheme, params), null);
                    }
  
                    // DSK
                    case 30:
                    case 31:
                    case 32:
                    case 33:
                    {
                        urlScheme = 'http://maps.google.com/maps?daddr=';
  
                        if(indexOf(os, 'mac') ?ge 0)
                        {
                             command = 'open ';
                        }
                        else
                        {
                              if(indexOf(os, 'win') ?ge 0)
                              {
                                command = 'rundll32 url.dll,FileProtocolHandler ';
                              }
                              else
                              {
                                if(indexOf(os, 'nix') ?ge 0 ?or (indexOf(os, 'nux') ?ge 0))
                                {
                                      command = 'xdg-open ';
                                }
                              }
                        }
  
  						params = conCat(locLat, comma, locLong);
                        id = connect(conCat('exec://', command, urlScheme, params), null);
                    }
  
                    // iOS
                    case 40:
                    {
                          urlScheme = '%google-maps-real-time-navigation/id585027354%comgooglemaps://';
                          params = conCat('?q=', locLat, comma, locLong);
  
                          id = connect(conCat('exec:', urlScheme, params), null);
                    }
  
              }
  
              try
              {
                     
                  close(id);
              }
              catch(e)
              {
  
              }
            }
            </syncDownloadAssignment>
            
            <name>Service Planning (Test)</name>
            
            <visibleExpression> 				
  				$global:SPVisible
  			</visibleExpression>
  			
        </movelet>
        
//---------------------------------------------------------------------------------------    
// Sync Intermovelets
//---------------------------------------------------------------------------------------           
        <movelet initialQuestionKey="#1" moveletKey="ORTEC_BC_INT_v1.1"
            moveletKeyExtension="" moveletType="MULTI" validTillDate="2999-06-30T11:59:59.000Z"
            namespace="E16QA#" visible="false">
            <question key="#1" type="41">
                <answer action="UPLOADONLYSILENT" key="#1_1" nextQuestionKey="END">
                    <text>Send</text>
                </answer>
            </question>
            <name>Sync Intermovelet (Test)</name>
        </movelet>
        
        <movelet initialQuestionKey="#1" moveletKey="ORTEC_BC_INT2_v1.1"
            moveletKeyExtension="" moveletType="MULTI" validTillDate="2999-06-30T11:59:59.000Z"
            namespace="E16QA#" visible="false">
            <question key="#1" type="41">
                <answer action="FULLSYNCSILENT" key="#1_1" nextQuestionKey="END">
                    <text>Send</text>
                </answer>
            </question>
            <name>Sync Intermovelet (Test)</name>
        </movelet>        
//---------------------------------------------------------------------------------------    
        
    </moveletSet>
    
    <moveletAssignment moveletKey="ORTEC_BC_SP_v1.1"> 
    	<participant deviceAddress="${#Project#QAAppGroup}" name="ORTEC_BC" participantKey="ORTEC_BC"/>
    </moveletAssignment>
    
    <moveletAssignment moveletKey="ORTEC_BC_INT_v1.1">
        <participant deviceAddress="${#Project#QAAppGroup}" name="ORTEC_BC" participantKey="ORTEC_BC"/>
    </moveletAssignment>
    
    <moveletAssignment moveletKey="ORTEC_BC_INT2_v1.1">
        <participant deviceAddress="${#Project#QAAppGroup}" name="ORTEC_BC" participantKey="ORTEC_BC"/>
    </moveletAssignment>
        
</MovilizerRequest>
